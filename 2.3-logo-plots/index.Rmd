---
title: "Logoplots"
subtitle: "SISBID 2016"
author: "Di Cook (dicook@monash.edu, @visnut); Heike Hofmann (heike.hofmann@gmail.com, @heike_hh)"
date: "`r Sys.Date()`"
output:
  ioslides_presentation:
    transition: default
    widescreen: true
css:
  styles.css
---

```{r, echo = FALSE, warning = FALSE, message=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  collapse = TRUE,
  comment = "#>",
  fig.height = 4,
  fig.width = 8,
  fig.align = "center",
  cache = FALSE
)
library(ggplot2)
library(tidyr)
library(dplyr)
library(lubridate)
library(scales)
library(readr)
library(ggmap)
library(HLMdiag)
library(RColorBrewer)
library(gridExtra)
library(gglogo)
```

## Sequence Logo plots

![](http://weblogo.berkeley.edu/img/cap_hth.png)

- Logo plots (Schneider & Stephens, 1990) show consensus sequences of aligned DNA or peptide sequences
- various (online) apps to create sequence plots, e.g. [Weblogo 3.0](http://weblogo.berkeley.edu/logo.cgi)
- bit dubious: several design aspects  of the plot does not reflect best practice from cognitive perspective

Schneider TD, Stephens RM. Sequence logos: a new way to display consensus sequences. Nucleic Acids Research. 1990;18(20):6097-6100.

## Sequence Logos

read FASTA file


`read.fasta` or `read.alignment(format="fasta")`
```{r}
library(seqinr)
pfam <- read.fasta(file = "data/pfam.fasta", as.string=TRUE, seqtype="AA", seqonly=TRUE)
head(pfam, 3)
```

##

```{r}
library(gglogo)
ggpfam <- ggfortify(data=data.frame(sequences = unlist(pfam))
, seq="sequences")
head(ggpfam[order(ggpfam$position),])
```

## 


```{r}
ggplot(data=ggpfam) +
  geom_logo(aes(x = position, label=element, y = bits, fill=interaction(Polarity, Water))) +
  scale_fill_brewer(palette="Paired") +
  theme_bw() +
  theme(legend.position= "bottom")
```


## Cognitiviely, this approach is better because ...

- each letter is enveloped within a rectangle (signal independent of the shape of the letter - compare e.g. `W` and `I`)
- rectangles are colored rather than the letters
- the main sequences is emphasized by being the only one along the top
- the secondary sequence is aligned at the top, making it easy to compare as well (Cleveland & McGill, 1984)
- colour scheme and legend

`position = "logo"`

## Another example


```{r}
data(sequences, package = "gglogo")

```

## Your turn

![](rainbow-lorikeet.png)

- What is a (data) plot?
- What are the three most important data plots?


## Share and share alike

This work is licensed under the Creative Commons Attribution-Noncommercial 3.0 United States License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc/ 3.0/us/ or send a letter to Creative Commons, 171 Second Street, Suite 300, San Francisco, California, 94105, USA.
